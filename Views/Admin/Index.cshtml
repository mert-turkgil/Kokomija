@model Kokomija.Models.ViewModels.Admin.AdminDashboardViewModel
@{
    ViewData["Title"] = "Admin Dashboard";
}

@section Styles {
    <style>
        .stat-card-clickable {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
        }
        .stat-card-clickable:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        }
        .stat-card-clickable:active {
            transform: translateY(-2px);
        }
        
        /* Fixed height scrollable containers */
        .recent-activity-card .card-body {
            width: 636px;
            max-width: 100%;
            height: 286.53px;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        .recent-activity-card .empty-state {
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
    </style>
}

<div class="admin-dashboard">
    <div class="container py-4">
        <!-- Welcome Card -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="welcome-card">
                    <h1>
                        <i class="bi bi-speedometer2"></i>
                        Admin Dashboard
                    </h1>
                    <p class="mb-0">Welcome back! Here's what's happening with your store today.</p>
                </div>
            </div>
        </div>

        <!-- Quick Stats Row 1 -->
        <div class="row mb-4">
            <div class="col-md-3 mb-3">
                <div class="stat-card">
                    <div class="stat-icon bg-primary">
                        <i class="bi bi-people"></i>
                    </div>
                    <div class="stat-content">
                        <h3 class="stat-value">@Model.TotalUsers</h3>
                        <p class="stat-label">Total Users</p>
                        <small class="text-muted">@Model.ActiveUsers Active</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="stat-card">
                    <div class="stat-icon bg-success">
                        <i class="bi bi-bag-check"></i>
                    </div>
                    <div class="stat-content">
                        <h3 class="stat-value">@Model.TotalOrders</h3>
                        <p class="stat-label">Total Orders</p>
                        <small class="text-muted">@Model.PendingOrders Pending</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="stat-card">
                    <div class="stat-icon bg-warning">
                        <i class="bi bi-box-seam"></i>
                    </div>
                    <div class="stat-content">
                        <h3 class="stat-value">@Model.TotalProducts</h3>
                        <p class="stat-label">Products</p>
                        <small class="text-muted">@Model.ActiveProducts Active</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="stat-card">
                    <div class="stat-icon bg-info">
                        <i class="bi bi-currency-dollar"></i>
                    </div>
                    <div class="stat-content">
                        <h3 class="stat-value">@Model.TotalRevenue.ToString("N0") @Model.Currency</h3>
                        <p class="stat-label">Total Revenue</p>
                        <small class="text-muted">@Model.MonthlyRevenue.ToString("N0") This Month</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Stats Row 2 -->
        <div class="row mb-4">
            <div class="col-md-3 mb-3">
                <div class="stat-card">
                    <div class="stat-icon bg-success">
                        <i class="bi bi-check-circle"></i>
                    </div>
                    <div class="stat-content">
                        <h3 class="stat-value">@Model.CompletedOrders</h3>
                        <p class="stat-label">Completed Orders</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="stat-card">
                    <div class="stat-icon bg-danger">
                        <i class="bi bi-exclamation-triangle"></i>
                    </div>
                    <div class="stat-content">
                        <h3 class="stat-value">@Model.OutOfStockProducts</h3>
                        <p class="stat-label">Out of Stock</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <a asp-action="BlogSettings" class="text-decoration-none">
                    <div class="stat-card stat-card-clickable">
                        <div class="stat-icon bg-info">
                            <i class="bi bi-newspaper"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value">@Model.PublishedBlogs</h3>
                            <p class="stat-label">Published Blogs</p>
                            <small class="text-muted">@Model.DraftBlogs Drafts</small>
                        </div>
                    </div>
                </a>
            </div>
            <div class="col-md-3 mb-3">
                <div class="stat-card">
                    <div class="stat-icon bg-secondary">
                        <i class="bi bi-envelope"></i>
                    </div>
                    <div class="stat-content">
                        <h3 class="stat-value">@Model.NewsletterSubscribers</h3>
                        <p class="stat-label">Newsletter Subs</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Activity Section -->
        <div class="row mb-4">
            <!-- Recent Orders -->
            <div class="col-lg-6 mb-4">
                        <h5 class="border-bottom pb-2 mb-3">
                            <i class="bi bi-cart"></i> Recent Orders
                        </h5>
                <div class="recent-activity-card">
                    <div class="card-body">
                        @if (Model.RecentOrders.Any())
                        {
                            <ul class="list-group list-group-flush">
                                @foreach (var order in Model.RecentOrders)
                                {
                                    <li class="list-group-item">
                                        <div class="item-content">
                                            <div class="item-icon bg-success-subtle">
                                                <i class="bi bi-bag"></i>
                                            </div>
                                            <div class="item-details">
                                                <p class="item-title">#@order.OrderNumber</p>
                                                <p class="item-subtitle">@order.CustomerName (@order.CustomerEmail)</p>
                                                <span class="status-badge status-@order.PaymentStatus">@order.PaymentStatus</span>
                                            </div>
                                            <div class="item-meta">
                                                <p class="item-value">@order.TotalAmount.ToString("N2") @order.Currency</p>
                                                <p class="item-time">@order.CreatedAt.ToString("MMM dd, HH:mm")</p>
                                            </div>
                                        </div>
                                    </li>
                                }
                            </ul>
                        }
                        else
                        {
                            <div class="empty-state">
                                <i class="bi bi-inbox"></i>
                                <p>No recent orders</p>
                            </div>
                        }
                    </div>
                </div>
            </div>

            <!-- Recent Users -->
            <div class="col-lg-6 mb-4">
                        <h5 class="border-bottom pb-2 mb-3">
                            <i class="bi bi-person-plus"></i> Recent Users
                        </h5>
                <div class="recent-activity-card">
                    <div class="card-body">
                        @if (Model.RecentUsers.Any())
                        {
                            <ul class="list-group list-group-flush">
                                @foreach (var user in Model.RecentUsers)
                                {
                                    <li class="list-group-item">
                                        <div class="item-content">
                                            <div class="item-icon bg-primary-subtle">
                                                <i class="bi bi-person"></i>
                                            </div>
                                            <div class="item-details">
                                                <p class="item-title">@user.FullName</p>
                                                <p class="item-subtitle">@user.Email</p>
                                                <span class="vip-tier tier-@user.VipTier.ToLower()">@user.VipTier</span>
                                            </div>
                                            <div class="item-meta">
                                                <p class="item-value">@user.TotalSpent.ToString("N0") PLN</p>
                                                <p class="item-time">@user.CreatedAt.ToString("MMM dd, yyyy")</p>
                                            </div>
                                        </div>
                                    </li>
                                }
                            </ul>
                        }
                        else
                        {
                            <div class="empty-state">
                                <i class="bi bi-people"></i>
                                <p>No recent users</p>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Low Stock & Recent Reviews -->
        <div class="row mb-4">
            <!-- Low Stock Products -->
            <div class="col-lg-6 mb-4">
                        <h5 class="border-bottom pb-2 mb-3">
                            <i class="bi bi-exclamation-circle"></i> Low Stock Alert
                        </h5>
                <div class="recent-activity-card">
                    <div class="card-body">
                        @if (Model.LowStockProducts.Any())
                        {
                            <ul class="list-group list-group-flush">
                                @foreach (var product in Model.LowStockProducts)
                                {
                                    <li class="list-group-item">
                                        <div class="item-content">
                                            @if (!string.IsNullOrEmpty(product.ImageUrl))
                                            {
                                                <img src="@product.ImageUrl" alt="@product.Name" class="product-thumb">
                                            }
                                            else
                                            {
                                                <div class="item-icon bg-warning-subtle">
                                                    <i class="bi bi-box"></i>
                                                </div>
                                            }
                                            <div class="item-details">
                                                <p class="item-title">@product.Name</p>
                                                <p class="item-subtitle">@product.Price.ToString("N2") PLN</p>
                                            </div>
                                            <div class="item-meta">
                                                <p class="item-value text-danger">@product.TotalStock units</p>
                                                <p class="item-time">Low Stock</p>
                                            </div>
                                        </div>
                                    </li>
                                }
                            </ul>
                        }
                        else
                        {
                            <div class="empty-state">
                                <i class="bi bi-check-circle"></i>
                                <p>All products in stock</p>
                            </div>
                        }
                    </div>
                </div>
            </div>

            <!-- Recent Reviews -->
            <div class="col-lg-6 mb-4">
                        <h5 class="border-bottom pb-2 mb-3">
                            <i class="bi bi-star"></i> Recent Reviews
                        </h5>
                <div class="recent-activity-card">
                    <div class="card-body">
                        @if (Model.RecentReviews.Any())
                        {
                            <ul class="list-group list-group-flush">
                                @foreach (var review in Model.RecentReviews)
                                {
                                    <li class="list-group-item">
                                        <div class="item-content">
                                            <div class="item-icon bg-warning-subtle">
                                                <i class="bi bi-star-fill"></i>
                                            </div>
                                            <div class="item-details">
                                                <p class="item-title">@review.ProductName</p>
                                                <p class="item-subtitle">@review.UserName</p>
                                                <div class="rating-stars">
                                                    @for (int i = 0; i < (int)review.Rating; i++)
                                                    {
                                                        <i class="bi bi-star-fill"></i>
                                                    }
                                                    @if (review.Rating % 1 != 0)
                                                    {
                                                        <i class="bi bi-star-half"></i>
                                                    }
                                                </div>
                                            </div>
                                            <div class="item-meta">
                                                @if (review.IsVisible)
                                                {
                                                    <span class="badge bg-success">Visible</span>
                                                }
                                                else
                                                {
                                                    <span class="badge bg-warning">Pending</span>
                                                }
                                                <p class="item-time">@review.CreatedAt.ToString("MMM dd")</p>
                                            </div>
                                        </div>
                                    </li>
                                }
                            </ul>
                        }
                        else
                        {
                            <div class="empty-state">
                                <i class="bi bi-star"></i>
                                <p>No recent reviews</p>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Actions -->
        <div class="row">
            <div class="col-md-6 col-lg-4 mb-3">
                <div class="admin-action-card">
                    <div class="action-icon">
                        <i class="bi bi-people"></i>
                    </div>
                    <h5>User Management</h5>
                    <p class="text-muted">Manage customer accounts, ban users, and moderate reviews</p>
                    <a asp-action="UserManagement" class="btn btn-outline-primary w-100">
                        Manage Users
                        <i class="bi bi-arrow-right ms-2"></i>
                    </a>
                </div>
            </div>

            <div class="col-md-6 col-lg-4 mb-3">
                <div class="admin-action-card">
                    <div class="action-icon">
                        <i class="bi bi-box-seam"></i>
                    </div>
                    <h5>Product Management</h5>
                    <p class="text-muted">Add, edit, and manage your product catalog</p>
                    <a asp-action="Products" class="btn btn-outline-primary w-100">
                        Manage Products
                        <i class="bi bi-arrow-right ms-2"></i>
                    </a>
                </div>
            </div>

            <div class="col-md-6 col-lg-4 mb-3">
                <div class="admin-action-card">
                    <div class="action-icon">
                        <i class="bi bi-bag-check"></i>
                    </div>
                    <h5>Order Management</h5>
                    <p class="text-muted">View and process customer orders</p>
                    <a asp-action="Orders" class="btn btn-outline-primary w-100">
                        Manage Orders
                        <i class="bi bi-arrow-right ms-2"></i>
                    </a>
                </div>
            </div>

            <div class="col-md-6 col-lg-4 mb-3">
                <div class="admin-action-card">
                    <div class="action-icon">
                        <i class="bi bi-newspaper"></i>
                    </div>
                    <h5>Blog Management</h5>
                    <p class="text-muted">Create and manage blog posts and articles</p>
                    <div class="d-grid gap-2">
                        <a asp-action="BlogCreate" class="btn btn-primary">
                            <i class="bi bi-plus-circle me-2"></i>Create New Blog
                        </a>
                        <a asp-action="BlogSettings" class="btn btn-outline-primary">
                            <i class="bi bi-list-ul me-2"></i>Manage Blogs
                        </a>
                    </div>
                </div>
            </div>

            <div class="col-md-6 col-lg-4 mb-3">
                <div class="admin-action-card">
                    <div class="action-icon">
                        <i class="bi bi-gear"></i>
                    </div>
                    <h5>Site Settings</h5>
                    <p class="text-muted">Configure site settings and preferences</p>
                    <a asp-action="Settings" class="btn btn-outline-primary w-100">
                        Settings
                        <i class="bi bi-arrow-right ms-2"></i>
                    </a>
                </div>
            </div>

            <div class="col-md-6 col-lg-4 mb-3">
                <div class="admin-action-card">
                    <div class="action-icon">
                        <i class="bi bi-house"></i>
                    </div>
                    <h5>Back to Store</h5>
                    <p class="text-muted">Return to the main website</p>
                    <a asp-controller="Home" asp-action="Index" class="btn btn-outline-primary w-100">
                        View Store
                        <i class="bi bi-arrow-right ms-2"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

